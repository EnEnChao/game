<!DOCTYPE html>
<html>
<head>
    <title>打地鼠遊戲</title>
    <style>
        #game {
            display: flex;
            flex-wrap: wrap;
            width: 600px;
            margin: 0 auto;
        }

        .hole {
            width: 100px;
            height: 100px;
            background-image: url('mole.png');
            background-size: contain;
            background-repeat: no-repeat;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }

        .hole.up {
            background-position-y: -100px;
        }

        .hole.hit {
            background-position-y: -200px;
        }
    </style>
</head>
<body>
    <h1>打地鼠遊戲</h1>
    <div id="game">
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
    </div>
    <script>
        const holes = document.querySelectorAll('.hole');
        const scoreBoard = document.querySelector('.score');
        const moles = document.querySelectorAll('.mole');
        let lastHole;
        let timeUp = false;
        let score = 0;

        function randomTime(min, max) {
          return Math.round(Math.random() * (max - min) + min);
        }

        function randomHole(holes) {
          const idx = Math.floor(Math.random() * holes.length);
          const hole = holes[idx];
          if (hole === lastHole) {
            return randomHole(holes);
          }
          lastHole = hole;
          return hole;
        }

        function peep() {
          const time = randomTime(200, 1000);
          const hole = randomHole(holes);
          hole.classList.add('up');
          setTimeout(() => {
            hole.classList.remove('up');
            if (!timeUp) peep();
          }, time);
        }

        function startGame() {
          scoreBoard.textContent = 0;
          timeUp = false;
          score = 0;
          peep();
          setTimeout(() => timeUp = true, 10000);
        }

        function bonk(e) {
          if (!e.isTrusted) return;
          score++;
          this.classList.remove('up');
          this.classList.add('hit');
          setTimeout(() => this.classList.remove('hit'), 300);
          scoreBoard.textContent = score;
        }

        moles.forEach(mole => mole.addEventListener('click', bonk));
    </script>
</body>
</html>